---
import { getCollection } from 'astro:content';

const allContent = await getCollection('mechanical');

// Group by subject (from frontmatter.subject)
const grouped = {};

allContent.forEach((entry) => {
  const subject = entry.data.subject;
  if (!grouped[subject]) {
    grouped[subject] = [];
  }
  grouped[subject].push(entry);
});

// Sort subjects manually or alphabetically?
// The syllabus order in the script was logical.
// I'll define a subject order map to keep the syllabus flow correct.
const subjectOrder = [
  'Engineering Mathematics',
  'Engineering Mechanics',
  'Mechanics of Materials',
  'Theory of Machines',
  'Vibrations',
  'Machine Design',
  'Fluid Mechanics',
  'Heat Transfer',
  'Thermodynamics',
  'Applied Thermodynamics',
  'Engineering Materials',
  'Manufacturing Engineering',
  'Industrial Engineering'
];

const subjects = Object.keys(grouped).sort((a, b) => {
  const indexA = subjectOrder.indexOf(a);
  const indexB = subjectOrder.indexOf(b);
  if (indexA === -1 && indexB === -1) return a.localeCompare(b);
  if (indexA === -1) return 1;
  if (indexB === -1) return -1;
  return indexA - indexB;
});

---

<nav class="space-y-6">
  {subjects.map(subject => (
    <div>
      <h3 class="font-bold text-slate-900 dark:text-white uppercase tracking-wider text-sm mb-2 px-2">
        {subject}
      </h3>
      <ul class="space-y-1">
        {grouped[subject]
          .sort((a, b) => (a.data.order || 0) - (b.data.order || 0))
          .map(entry => (
          <li>
            <a
              href={`/mechanical/${entry.slug}`}
              class="block px-2 py-1.5 text-sm text-slate-600 dark:text-slate-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-slate-50 dark:hover:bg-slate-800 rounded transition-colors"
            >
              {entry.data.title}
            </a>
          </li>
        ))}
      </ul>
    </div>
  ))}
</nav>
